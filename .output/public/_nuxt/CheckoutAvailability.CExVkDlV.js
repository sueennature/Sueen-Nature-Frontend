import{_ as C,Q as y,o as a,c as l,a as o,C as u,E as m,t as x,F as D,s as T,I as S,u as O,D as A,d as b,x as E,p as I,e as V}from"./entry.BGkenJoE.js";import{i as _}from"./index.BLr9LH-W.js";const U={data(){return{check_in:"",check_out:"",roomCategory:null,roomView:null,room_types:[],selectedCategories:[],discount_code:"",dropdownOpen:!1,loading:!1}},methods:{formatDateToISO(e){const t=new Date(e),n=t.getUTCFullYear(),d=String(t.getUTCMonth()+1).padStart(2,"0"),s=String(t.getUTCDate()).padStart(2,"0"),i=String(t.getUTCHours()).padStart(2,"0"),r=String(t.getUTCMinutes()).padStart(2,"0");return`${n}-${d}-${s}T${i}:${r}:00.000Z`},populateFieldsFromQuery(){const{fromDate:e,toDate:t,categories:n,view:d,discount:s}=this.$route.query;this.check_in=e||this.formatDateTime(new Date),this.check_out=t||this.formatDateTime(new Date(new Date().getTime()+2*60*60*1e3)),this.roomView=d||null,this.discount_code=s||"",console.log("FROM_URL",this.check_in,this.check_out),n?this.selectedCategories=n.split(","):this.selectedCategories=[],console.log("Populated Categories:",this.selectedCategories)},formatDateTime(e){if(!(e instanceof Date)||isNaN(e))return"";const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),d=String(e.getDate()).padStart(2,"0"),s=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${t}-${n}-${d}T${s}:${i}`},selectCategory(e){this.selectedCategories.includes(e)?this.selectedCategories=this.selectedCategories.filter(t=>t!==e):this.selectedCategories.push(e),console.log("Selected Categories after update:",this.selectedCategories)},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},selectCategory(e){this.selectedCategories.includes(e)?this.selectedCategories=this.selectedCategories.filter(t=>t!==e):this.selectedCategories.push(e)},closeDropdown(){this.dropdownOpen=!1},async fetchRoomTypes(){try{const e=await fetch("https://api.sueennature.com/rooms/types",{method:"GET",headers:{"Content-Type":"application/json","x-api-key":this.$config.public.DATABASE_ID}});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();this.room_types=t.room_types||[]}catch(e){console.error("There has been a problem with your fetch operation:",e)}},async checkAvailability(){if(!this.check_in||!this.check_out||!this.roomView||this.selectedCategories.length===0)return this.setupToastError("Please fill all fields");const e=new Date(this.check_in),t=new Date(this.check_out),n=e.toISOString().split("T")[0],d=t.toISOString().split("T")[0];if(n===d)return _.error("Check-out date must be different from check-in date.");if(t<=e)return this.setupToastError("Check-out date must be after check-in date");const s=h=>{const p=new Date(h),w=p.getTimezoneOffset();return new Date(p.getTime()-w*60*1e3).toISOString().slice(0,19)},i=s(this.check_in),r=s(this.check_out);console.log("FORMATTED",i,r);const g=E(),v="https://api.sueennature.com/rooms/availability/",k=new URLSearchParams({check_in:i,check_out:r,views:this.roomView,discount_code:this.discount_code});this.selectedCategories.forEach(h=>{k.append("categories",h)});const f=`${v}?${k.toString()}`;console.log("URL",f),this.loading=!0;try{const h=await fetch(f,{method:"GET",headers:{"x-api-key":g.public.DATABASE_ID,"Content-Type":"application/json"}}),p=await h.json();if(this.loading=!1,h.status===200)this.setupToastSuccess("Availability checked successfully."),setTimeout(()=>{window.location.reload()},1500),this.$router.push({path:"/booking",query:{fromDate:this.check_in,toDate:this.check_out,categories:this.selectedCategories.join(","),view:this.roomView,discount:this.discount_code}});else if(h.status===204)this.setupToastError("No rooms available.");else{const w=await h.json();this.setupToastError(`An error occurred: ${w.message||"Unknown error"}`)}}catch(h){this.loading=!1,this.setupToastError(`An error occurred: ${h.message}`)}},setupToastSuccess(e){_.success(e,{autoClose:3e3})},setupToastError(e){_.error(e,{autoClose:3e3})},handleClickOutside(e){this.dropdownOpen&&!this.$refs.dropdownContainer.contains(e.target)&&(this.dropdownOpen=!1)}},mounted(){this.populateFieldsFromQuery(),document.addEventListener("click",this.handleClickOutside),this.fetchRoomTypes(),Promise.all([y(()=>import("./Datepicker.DZp4Y7Zh.js"),__vite__mapDeps([]),import.meta.url),y(()=>import("./Datepicker.DZp4Y7Zh.js"),__vite__mapDeps([]),import.meta.url)]).then(([e,t])=>{const n=this.$refs.datepicker1,d=this.$refs.datepicker2;new e.default(n,{autohide:!0,orientation:"bottom right"}),new t.default(d,{autohide:!0,orientation:"bottom right"})})},beforeDestroy(){document.removeEventListener("click",this.handleClickOutside)}},c=e=>(I("data-v-caecd611"),e=e(),V(),e),M={class:"relative"},j={class:"inset-x-0 lg:flex lg:flex-col xl:flex-row flex-col lg:justify-center lg:mx-0 mx-4"},L={class:"xl:flex grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 items-center justify-center lg:space-x-0 border rounded-l-none rounded-r-none lg:rounded-l-lg lg:rounded-r-none shadow-lg border-white bg-black-200 bg-opacity-65"},R={class:"relative lg:max-w-xs lg:mx-auto"},N=c(()=>o("div",{class:"w-0.5 bg-white h-8 my-auto xl:flex hidden"},null,-1)),F={class:"relative lg:max-w-xs lg:mx-auto"},B=c(()=>o("div",{class:"w-0.5 bg-white h-8 my-auto xl:flex hidden"},null,-1)),P={class:"lg:max-w-sm lg:mx-auto"},z={class:"relative"},Q={class:"overflow-hidden text-ellipsis whitespace-nowrap w-24"},q={key:0},G={key:1},H={class:"ml-1"},K={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},Y=c(()=>o("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 01.707.293l7 7a1 1 0 11-1.414 1.414L10 5.414l-6.293 6.293a1 1 0 01-1.414-1.414l7-7A1 1 0 0110 3z","clip-rule":"evenodd"},null,-1)),$=[Y],Z={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor"},J=c(()=>o("path",{"fill-rule":"evenodd",d:"M10 17a1 1 0 01-.707-.293l-7-7a1 1 0 011.414-1.414L10 14.586l6.293-6.293a1 1 0 111.414 1.414l-7 7A1 1 0 0110 17z","clip-rule":"evenodd"},null,-1)),W=[J],X={key:0,class:"absolute mt-2 w-full max-w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg z-10"},ee=["onClick"],te=["value","checked","onChange"],oe={class:"text-gray-900 dark:text-white"},se=c(()=>o("div",{class:"w-0.5 bg-white h-8 my-auto xl:flex hidden"},null,-1)),re={class:"lg:max-w-sm lg:mx-auto"},ie=c(()=>o("option",{value:null,disabled:"",selected:"",class:"text-gray-900"}," Choose Room View ",-1)),ae=c(()=>o("option",{value:"LAKE",class:"text-gray-900"},"LAKE",-1)),le=c(()=>o("option",{value:"MOUNTAIN",class:"text-gray-900"},"MOUNTAIN",-1)),ne=[ie,ae,le],ce=c(()=>o("div",{class:"w-0.5 bg-white h-8 my-auto xl:flex hidden"},null,-1)),de={class:"lg:max-w-sm lg:mx-auto"},he={key:0,class:"flex"},ue=c(()=>o("svg",{class:"animate-spin h-5 w-5 mr-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l4-4-4-4v4a8 8 0 01-8 8z"})],-1)),ge={key:1},pe={class:"lg:hidden"},we={key:0,class:"flex items-center justify-center"},me=c(()=>o("svg",{class:"animate-spin h-5 w-5 mr-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4l4-4-4-4v4a8 8 0 01-8 8z"})],-1)),_e={key:1};function ke(e,t,n,d,s,i){return a(),l("div",M,[o("div",j,[o("div",L,[o("div",R,[u(o("input",{type:"datetime-local",class:"w-full bg-transparent border-none rounded-lg text-white placeholder-gray-500 text-sm p-4 focus:ring-0 block dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Check In Date","onUpdate:modelValue":t[0]||(t[0]=r=>s.check_in=r)},null,512),[[m,s.check_in]])]),N,o("div",F,[u(o("input",{type:"datetime-local",class:"w-full border-none bg-transparent rounded-lg text-white placeholder-gray-500 text-sm p-4 focus:ring-0 block dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"Check Out Date","onUpdate:modelValue":t[1]||(t[1]=r=>s.check_out=r)},null,512),[[m,s.check_out]])]),B,o("div",P,[o("div",z,[o("div",{onClick:t[2]||(t[2]=(...r)=>i.toggleDropdown&&i.toggleDropdown(...r)),ref:"dropdownContainer",class:"text-white text-sm p-4 bg-transparent border-none rounded-0 focus:ring-0 focus:border-white dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 cursor-pointer flex justify-between items-center"},[o("div",Q,[s.selectedCategories.length===0?(a(),l("span",q,"Choose Rooms")):(a(),l("span",G,x(s.selectedCategories.join(", ")),1))]),o("div",H,[s.dropdownOpen?(a(),l("svg",K,$)):(a(),l("svg",Z,W))])],512),s.dropdownOpen?(a(),l("div",X,[(a(!0),l(D,null,T(s.room_types,r=>(a(),l("div",{key:r.value,class:"p-2 cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 flex items-center",onClick:S(g=>i.selectCategory(r.category),["stop"])},[o("input",{type:"checkbox",value:r.category,checked:s.selectedCategories.includes(r.category),onChange:g=>i.selectCategory(r.category),class:"mr-2"},null,40,te),o("span",oe,x(r.category),1)],8,ee))),128))])):O("",!0)])]),se,o("form",re,[u(o("select",{id:"view",class:"text-white text-sm p-4 bg-transparent border-none rounded-0 focus:ring-0 focus:border-white block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500","onUpdate:modelValue":t[3]||(t[3]=r=>s.roomView=r)},ne,512),[[A,s.roomView]])]),ce,o("form",de,[u(o("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s.discount_code=r),type:"text",placeholder:"Discount Code",class:"text-white text-sm p-4 bg-transparent border-none rounded-0 focus:ring-0 focus:border-white block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"},null,512),[[m,s.discount_code]])])]),o("button",{class:"bg-red-100 hover:bg-red-500 text-sm text-center text-white p-2 md:p-4 rounded xl:rounded-r-lg xl:rounded-l-none hidden justify-center lg:flex",onClick:t[5]||(t[5]=(...r)=>i.checkAvailability&&i.checkAvailability(...r))},[s.loading?(a(),l("span",he,[ue,b(" Loading... ")])):(a(),l("span",ge,"Check Availability"))]),o("div",pe,[o("button",{class:"bg-red-100 hover:bg-red-500 buttontext text-sm text-white p-4 rounded-none border border-white w-full",onClick:t[6]||(t[6]=(...r)=>i.checkAvailability&&i.checkAvailability(...r))},[s.loading?(a(),l("span",we,[me,b(" Loading... ")])):(a(),l("span",_e," Check Availability "))])])])])}const be=C(U,[["render",ke],["__scopeId","data-v-caecd611"]]);export{be as C};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
